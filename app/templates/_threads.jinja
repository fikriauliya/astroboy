<ul>
    {% for thread in threads %}
    <div class="collapse bg-base-200 my-3">
        {# <input type="checkbox" class="expand-box" id="expand_{{thread.id}}" hx-get="/messages/{{thread.id}}"
            hx-target="#chats_{{thread.id}}" hx-swap="innerHTML"> #}
        <input type="checkbox" class="expand-box" id="expand_{{thread.id}}">
        <div class=" collapse-title text-md font-medium">
            <div class="col-span-5">
            {{thread.name}}</div>
        </div>
        <div class="collapse-content">
            {% if thread.created_by == current_user.uid %}
            <form action="/threads/delete/{{thread.id}}" method="POST">
                <button class="btn btn-outline btn-xs btn-error">
                    Delete
                </button>
            </form>
            {% endif %}

            {# <div id="chats_{{thread.id}}" hx-ext="sse" sse-connect="/streams/messages/{{thread.id}}"
                sse-swap="ADDED">
            </div> #}
            <div id="chats_{{thread.id}}" sse-swap="ADDED_{{thread.id}}">
            </div>

            <form class="flex gap-4 py-4" hx-post="/messages/" hx-swap="none" hx-vars='{thread_id: "{{thread.id}}"}'>
                <input type="text" name="content" class="flex-grow input input-bordered"
                    placeholder="Your message"></textarea>
                <button class="btn btn-neutral">
                    Post
                    <span class="htmx-indicator loading loading-dots loading-sm"></span>

                </button>
            </form>
        </div>
    </div>
    {% endfor %}
</ul>